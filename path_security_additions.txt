# To fix path traversal vulnerability, add these changes:

## 1. Add to Makefile SRC_UTILS line:
Replace:
SRC_UTILS=src/utils/utils.c

With:
SRC_UTILS=src/utils/utils.c src/utils/path_security.c

## 2. The path_security.c file has been created with:
- is_path_traversal() - detects traversal patterns
- is_safe_path() - validates path safety
- sanitize_path() - normalizes and validates paths
- fopen_safe() - secure file opening wrapper

## 3. To use in your code, replace unsafe fopen() calls with:
FILE* f = fopen_safe(filepath, "r");  // instead of fopen(filepath, "r")

Or validate paths before using:
if (!is_safe_path(filepath)) {
    // reject the path
    return -1;
}
